[program:nginx]
command=/usr/sbin/nginx -g "daemon off;"
autostart=true
autorestart=true
stderr_logfile=/var/log/nginx/error.log
stdout_logfile=/var/log/nginx/access.log

[program:dinari-rpc]
command=/usr/local/bin/gunicorn --bind 127.0.0.1:5000 --workers 4 --worker-class uvloop --timeout 60 --keep-alive 10 app:app
directory=/app
user=dinari
autostart=true
autorestart=true
stderr_logfile=/app/logs/rpc-error.log
stdout_logfile=/app/logs/rpc-access.log
environment=NODE_TYPE="rpc",MINING_ENABLED="false",RPC_ENABLED="true"

[program:metrics-exporter]
command=/bin/bash -c 'while true; do curl -s http://localhost:5000/api/stats > /app/logs/metrics.json; sleep 60; done'
directory=/app
user=dinari
autostart=true
autorestart=true
stderr_logfile=/app/logs/metrics-error.log
stdout_logfile=/app/logs/metrics-access.log